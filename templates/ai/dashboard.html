{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Carmela AI â€“ Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Nanum+Pen+Script&display=swap" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    .perspective {
  perspective: 1200px;
}

#journalCard {
  transform-style: preserve-3d;
  transition: transform 0.8s ease;
  position: relative;
}

#journalCard.flipped {
  transform: rotateY(180deg);
}

.journal-face {
  backface-visibility: hidden;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.journal-back {
  transform: rotateY(180deg);
}


  </style>
</head>
<body class="bg-[#f0fdfa]  min-h-screen text-gray-800">


  <!-- Header -->
  <header class="w-full px-6 py-4 flex justify-between items-center bg-white shadow">
    <div class="text-lg font-semibold text-teal-700">Carmela AI</div>
    <a href="{% url 'logout' %}" class="text-sm text-gray-500 hover:text-teal-600 transition">Logout</a>
  </header>

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto px-6 py-14">

    <!-- Greeting -->
    <div class="text-center mb-12">
      <h1 class="text-3xl font-semibold text-gray-800 mb-1">Hey ğŸŒ¼</h1>
      <p class="text-gray-500 text-sm">Letâ€™s check in gently â€” howâ€™s your heart today?</p>
    </div>

    <!-- Mood Check Form -->
    <form method="post" class="flex flex-col sm:flex-row items-center gap-4 justify-center mb-16">
      {% csrf_token %}
      <input
        type="text"
        name="mood"
        placeholder="e.g., calm, tired, hopeful"
        class="w-full sm:w-80 px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-400 bg-white text-sm"
        required
      />
      <button
        type="submit"
        class="px-6 py-2 text-sm bg-teal-600 text-white rounded-md hover:bg-teal-700 transition font-medium">
        Save Mood
      </button>
    </form>

    <div class="mt-16 mb-20 text-center">
        <h2 class="text-xl font-semibold text-gray-800 mb-2">ğŸ“ Write with Carmela</h2>
        <p class="text-sm text-gray-500 mb-4">She can help you craft beautiful, effective writing.</p>
      
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-6 max-w-4xl mx-auto">
          <a href="{% url 'writing_tool' %}?type=email" class="bg-white rounded-xl p-4 shadow hover:shadow-md transition">
            <h3 class="text-base font-semibold text-teal-700">ğŸ“§ Email</h3>
            <p class="text-xs text-gray-500 mt-1">Warm, clear, and professional emails.</p>
          </a>
      
          <a href="{% url 'writing_tool' %}?type=caption" class="bg-white rounded-xl p-4 shadow hover:shadow-md transition">
            <h3 class="text-base font-semibold text-teal-700">ğŸ“± Caption</h3>
            <p class="text-xs text-gray-500 mt-1">Sparkly or heartfelt social captions.</p>
          </a>
      
          <a href="{% url 'writing_tool' %}?type=affirmation" class="bg-white rounded-xl p-4 shadow hover:shadow-md transition">
            <h3 class="text-base font-semibold text-teal-700">ğŸŒ Affirmation</h3>
            <p class="text-xs text-gray-500 mt-1">Short positive reminders, just for you.</p>
          </a>
      
          <a href="{% url 'rewrite_tool' %}" class="bg-white rounded-xl p-4 shadow hover:shadow-md transition">
            <h3 class="text-base font-semibold text-teal-700">âœï¸ Rewrite with Tone</h3>
            <p class="text-xs text-gray-500 mt-1">Make it sound more loving, confident, calm, or clear.</p>
          </a>
        </div>
      </div>
      
      

    <!-- Mode Selection -->
    <div class="text-center mb-8">
      <h2 class="text-xl font-semibold text-gray-800 mb-1">âœ¨ Pick Your Vibe</h2>
      <p class="text-sm text-gray-500">Choose how you'd like Carmela to support you today.</p>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-16">
        <a href="{% url 'chat' %}?mode=breathe&showPreloader=true" class="bg-white rounded-xl p-5 text-center shadow hover:shadow-md hover:scale-105 transition">
          <div class="text-3xl mb-2">ğŸ§˜â€â™€ï¸</div>
          <h3 class="font-semibold text-teal-700 text-base">Breathe & Be</h3>
          <p class="text-xs text-gray-500 mt-1">Gentle breathwork</p>
        </a>
        <a href="{% url 'chat' %}?mode=boss&showPreloader=true" class="bg-white rounded-xl p-5 text-center shadow hover:shadow-md hover:scale-105 transition">
          <div class="text-3xl mb-2">ğŸ’¼</div>
          <h3 class="font-semibold text-teal-700 text-base">Strategist</h3>
          <p class="text-xs text-gray-500 mt-1">Focus & clarity</p>
        </a>
        <a href="{% url 'chat' %}?mode=heart&showPreloader=true" class="bg-white rounded-xl p-5 text-center shadow hover:shadow-md hover:scale-105 transition">
          <div class="text-3xl mb-2">ğŸ’Œ</div>
          <h3 class="font-semibold text-teal-700 text-base">Confidant </h3>
          <p class="text-xs text-gray-500 mt-1">Soulful support</p>
        </a>
        <a href="{% url 'chat' %}?mode=sparkle&showPreloader=true" class="bg-white rounded-xl p-5 text-center shadow hover:shadow-md hover:scale-105 transition">
          <div class="text-3xl mb-2">âœ¨</div>
          <h3 class="font-semibold text-teal-700 text-base">BFF</h3>
          <p class="text-xs text-gray-500 mt-1">Joy & affirmations</p>
        </a>
      </div>

      <!-- Start Chat CTA -->
<div class="text-center space-y-4">
    <a href="{% url 'chat' %}" class="bg-teal-600 text-white text-sm px-8 py-3 rounded-full hover:bg-teal-700 transition font-medium inline-block">
      Talk to Carmela ğŸ’¬
    </a>
  
    <a href="#" onclick="openJournalModal()" class="bg-white border border-teal-500 text-teal-600 text-sm px-6 py-2 rounded-full hover:bg-teal-50 transition font-medium inline-block">
        Reflect with Carmela ğŸ’œ
      </a>
      
  </div>
  
      
<!-- Journal Notebook Modal -->
<div id="journalModal" class="fixed inset-0 z-50 bg-black bg-opacity-30 hidden justify-center items-center">
    <div class="relative w-full max-w-xl perspective">
      <div id="journalCard" class="transition-transform duration-700 preserve-3d relative w-full min-h-[500px] h-[500px]">
  
        <!-- FRONT: Write Entry -->
        <div class="journal-face w-full border border-teal-200 rounded-xl shadow-lg p-6 overflow-hidden bg-[#fffdf8]"
          style="background-image: linear-gradient(#fffdf8 39px, rgba(0,0,0,0.07) 40px); background-size: 100% 40px;">
  
          <!-- Spiral rings -->
          <div class="absolute -left-4 top-6 flex flex-col space-y-2">
            <div class="w-2 h-2 rounded-full bg-gray-400"></div>
            <div class="w-2 h-2 rounded-full bg-gray-400"></div>
            <div class="w-2 h-2 rounded-full bg-gray-400"></div>
          </div>
  
          <h3 class="text-2xl font-bold text-teal-700 mb-1 font-serif">ğŸ“ My Journal</h3>
          <p class="text-base text-gray-500 mb-4 font-serif">Take a gentle breath and write it out.</p>
  
          <form method="post" action="{% url 'save_journal' %}">
            {% csrf_token %}
            <textarea
              name="entry"
              placeholder="Dear Carmela, today I feel..."
              required
              class="w-full px-4 py-[20px] text-[19px] leading-[40px] font-light text-gray-800 font-['Nanum_Pen_Script',_cursive] bg-transparent focus:outline-none tracking-wide resize-none"
              style="min-height: 320px;"
            ></textarea>
  
            <div class="flex justify-between mt-6">
              <button type="button" onclick="closeJournalModal()" class="text-base text-gray-400 hover:text-gray-600">Cancel</button>
              <div class="flex gap-3">
                <button type="button" onclick="flipCard()" class="text-base text-teal-600 hover:text-teal-800">ğŸ“– View Entries</button>
                <button type="submit" class="bg-teal-600 text-white text-base px-6 py-3 rounded-md hover:bg-teal-700 transition font-medium">Save</button>
              </div>
            </div>
          </form>
        </div>
  
        <!-- BACK: View Past Entries -->
        <div class="journal-face journal-back w-full bg-[#fffdf8] border border-teal-200 rounded-xl shadow-lg p-6 h-full flex flex-col">
          <h3 class="text-2xl font-bold text-teal-700 mb-1 font-serif">ğŸ“– Past Entries</h3>
          <p class="text-base text-gray-500 mb-4 font-serif">Swipe through your recent reflections.</p>
  
          <div class="overflow-y-auto flex-1 pr-1 space-y-4 scroll-smooth">
            {% if journal_entries %}
              {% for entry in journal_entries %}
                <div class="bg-white rounded-lg border border-gray-200 px-4 py-3 shadow-sm">
                  <p class="text-sm text-gray-400">{{ entry.created_at|date:"F d, Y â€“ h:i A" }}</p>
                  <p class="text-base font-['Nanum_Pen_Script',_cursive] mt-1 whitespace-pre-line">{{ entry.entry|truncatewords:50 }}</p>
                </div>
              {% endfor %}
            {% else %}
              <p class="text-gray-400 text-base italic">No entries yet. Start with your first thought today ğŸŒ±</p>
            {% endif %}
          </div>
  
          <div class="flex justify-between mt-6">
            <button type="button" onclick="flipCard()" class="text-base text-teal-600 hover:text-teal-800">ğŸ“ Back to Write</button>
            <button type="button" onclick="closeJournalModal()" class="text-base text-gray-400 hover:text-gray-600">Close</button>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  
  

    <!-- Preloader -->
    <div id="preloader" class="hidden fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#f0fdfa]">

    <div style="width: 50px; height: 50px; border-radius: 50%; background: radial-gradient(circle, #a470ff, #5e19b3); box-shadow: 0 0 20px rgba(94,25,179,0.5); animation: pulse 1.5s infinite;"></div>
    <p style="margin-top: 12px; color: #0f766e; /* Tailwind teal-700 */ font-weight: 500;">Carmelaâ€™s tuning in ğŸ’«</p>
  </div>
  
  
  

  </main>

  <script>
    // Pulse animation
    const style = document.createElement('style');
    style.innerHTML = `
      @keyframes pulse {
        0% { transform: scale(1); opacity: 0.8; }
        50% { transform: scale(1.2); opacity: 1; }
        100% { transform: scale(1); opacity: 0.8; }
      }
    `;
    document.head.appendChild(style);
  
    // Intercept mood links
    document.querySelectorAll('a[href*="mode="]').forEach(link => {
  link.addEventListener('click', function (e) {
    e.preventDefault();

    const preloader = document.getElementById('preloader');
    preloader.classList.remove('hidden');

    setTimeout(() => {
      window.location.href = this.href;
    }, 1500);
  });
});

function openJournalModal() {
    document.getElementById('journalModal').classList.remove('hidden');
    document.getElementById('journalModal').classList.add('flex');
  }

  function closeJournalModal() {
    document.getElementById('journalModal').classList.remove('flex');
    document.getElementById('journalModal').classList.add('hidden');
    document.getElementById('journalCard').classList.remove('flipped');
  }

  function flipCard() {
    const card = document.getElementById('journalCard');
    card.classList.toggle('flipped');
  }
  </script>
</body>
</html>
